---
title: 现货交易交易构建
---

现货相关核心封装：

- `BalanceManagerContract`
- `DeepBookContract`
- `FlashLoanContract`

代码位置：`/Users/mac/work/sui-sdks/go-sdks/deepbook_v3/transactions`。

## 典型流程

1. 创建 `sui/transactions.Transaction`
2. 调用 DeepBook 合约方法写入 MoveCall
3. 继续拼接其它命令（可选）
4. `Build` / `BuildBase64` 交给签名与执行层

## 下单示例（限价单）

```go
tx := stx.NewTransaction()

client.DeepBook.PlaceLimitOrder(tx, types.PlaceLimitOrderParams{
	PoolKey:            "DEEP_SUI",
	BalanceManagerKey:  "main",
	ClientOrderID:      "1001",
	Price:              0.00012,
	Quantity:           25,
	IsBid:              true,
	Expiration:         0, // 0 会自动使用 MaxTimestamp
	OrderType:          types.OrderTypeNoRestriction,
	SelfMatchingOption: types.SelfMatchingAllowed,
	PayWithDeep:        false,
})

b64, err := tx.BuildBase64()
if err != nil {
	panic(err)
}
_ = b64
```

## 市价单与撤单

- 下市价单：`PlaceMarketOrder`
- 撤单：`CancelOrder`
- 批量撤单：`CancelOrders`
- 全撤：`CancelAllOrders`
- 改单：`ModifyOrder`

## 资金管理

- `DepositIntoManager`
- `WithdrawFromManager`
- `WithdrawAllFromManager`
- `CheckManagerBalance`（通过 client 提供 dry-run 查询版本）

## 费用与精度

内部会做精度换算：

- 价格换算：`price * FloatScalar * quoteScalar / baseScalar`
- 数量换算：`quantity * baseScalar`

默认 gas 预算会在若干高频方法里通过 `SetGasBudgetIfNotSet` 写入 `utils.GasBudget`。
